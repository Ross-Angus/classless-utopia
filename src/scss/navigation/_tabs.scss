@use "../vars-sass" as v;
@use "../mixins/carousel-inputs.scss";

// Tabs
[role="tablist"] {
  display: flex;
  flex-wrap: wrap;
  margin: 0 var(--gutter) calc(var(--keyline) * -0.5);

  // Tab buttons
  [role="tab"] {
    background: var(--tint1);
    border: solid var(--keyline) var(--bodytext);
    border-radius: calc(var(--cta-radius) / 2) calc(var(--cta-radius) / 2) 0 0;
    font-style: normal;
    font-weight: var(--bodytext-weight);
    line-height: var(--bodytext-line-height);
    margin: 0 calc(var(--keyline) / -4) calc(var(--keyline) * -0.5);
    padding: calc(var(--gutter) / 2) var(--gutter);
    text-align: center;
    overflow-wrap: normal;
    hyphens: manual;

    &[aria-selected="true"] {
      background: var(--background);
      border-bottom-color: var(--background);
    }

    &:hover,
    &:focus {
      @extend %carousel-focus !optional;
    }

    // Hiding the > chevron
    &::after {
      display: none;
    }
  }
}

// Tab panels
[role="tabpanel"] {
  border: var(--keyline) solid var(--bodytext);
  border-radius: calc(var(--cta-radius) / 2);
  padding: var(--gutter);

  &[hidden] {
    display: none;
  }
}

// If the browser supports scroll-marker-group, the tabs will be inside
// a carousel to avoid wrapping.
@supports (scroll-marker-group: after) {
  @media (prefers-reduced-motion: no-preference) {
    [role="tablist"] {
      scroll-behavior: smooth;
    }
  }

  [role="tablist"] {
    // anchor-name: --tabs;
    flex-wrap: nowrap;
    margin: 0 var(--btn-size) calc(var(--keyline) / -2);
    overflow: hidden;
    padding: 0 var(--gutter);
    position: relative;
    scroll-snap-type: x mandatory;

    [role="tab"] {
      scroll-snap-align: center;
      white-space: nowrap;
    }

    &::scroll-button(*) {
      aspect-ratio: 1;
      font-size: var(--largetext-size);
      position: absolute;
      top: 0;
      // position-anchor: --tabs;
      // I have no idea why this is required
      transform: translate(0, 100%);

      &:disabled {
        opacity: var(--disabled);

        &:hover {
          background: var(--tint2);
          cursor: not-allowed;
          outline: none;
        }
      }

      &:hover,
      &:focus-visible {
        cursor: pointer;
        @extend %carousel-focus !optional;
      }
    }

    &::scroll-button(left) {
      content: "⟪";
      left: 0;
      position-area: center left;
    }

    &::scroll-button(right) {
      content: "⟫";
      position-area: center right;
      right: 0;
    }
  }
}
